"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[2181],{4683:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"module-01-ros2/week-03/ch01-nodes-topics","title":"ROS 2 Nodes and Topics","description":"Learning Objectives","source":"@site/docs/module-01-ros2/week-03/ch01-nodes-topics.md","sourceDirName":"module-01-ros2/week-03","slug":"/module-01-ros2/week-03/ch01-nodes-topics","permalink":"/AI_COURSE_book/docs/module-01-ros2/week-03/ch01-nodes-topics","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-01-ros2/week-03/ch01-nodes-topics.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"ch01-nodes-topics","title":"ROS 2 Nodes and Topics","sidebar_label":"Nodes and Topics","sidebar_position":1},"sidebar":"textbookSidebar","previous":{"title":"Module 1: ROS 2 (Weeks 3-5)","permalink":"/AI_COURSE_book/docs/module-01-ros2"},"next":{"title":"Services & Actions","permalink":"/AI_COURSE_book/docs/module-01-ros2/week-03/ch02-services-actions"}}');var r=n(4848),l=n(8453);const o={id:"ch01-nodes-topics",title:"ROS 2 Nodes and Topics",sidebar_label:"Nodes and Topics",sidebar_position:1},t="ROS 2 Nodes and Topics",c={},d=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction to ROS 2 Architecture",id:"introduction-to-ros-2-architecture",level:2},{value:"The Compute Graph",id:"the-compute-graph",level:3},{value:"ROS 2 Nodes",id:"ros-2-nodes",level:2},{value:"Node Characteristics",id:"node-characteristics",level:3},{value:"Node Examples in a Mobile Robot",id:"node-examples-in-a-mobile-robot",level:3},{value:"Creating Your First Node",id:"creating-your-first-node",level:2},{value:"Step 1: Import Required Libraries",id:"step-1-import-required-libraries",level:3},{value:"Step 2: Define the Node Class",id:"step-2-define-the-node-class",level:3},{value:"Step 3: Main Function",id:"step-3-main-function",level:3},{value:"Running the Node",id:"running-the-node",level:3},{value:"ROS 2 Topics",id:"ros-2-topics",level:2},{value:"Topic Properties",id:"topic-properties",level:3},{value:"Topic Naming Conventions",id:"topic-naming-conventions",level:3},{value:"Creating a Subscriber Node",id:"creating-a-subscriber-node",level:2},{value:"Running Publisher and Subscriber Together",id:"running-publisher-and-subscriber-together",level:3},{value:"Standard ROS 2 Message Types",id:"standard-ros-2-message-types",level:2},{value:"Primitive Types (std_msgs)",id:"primitive-types-std_msgs",level:3},{value:"Geometry Messages (geometry_msgs)",id:"geometry-messages-geometry_msgs",level:3},{value:"Sensor Messages (sensor_msgs)",id:"sensor-messages-sensor_msgs",level:3},{value:"Navigation Messages (nav_msgs)",id:"navigation-messages-nav_msgs",level:3},{value:"Practical Example: Velocity Publisher for a Mobile Robot",id:"practical-example-velocity-publisher-for-a-mobile-robot",level:2},{value:"ROS 2 Command-Line Tools",id:"ros-2-command-line-tools",level:2},{value:"Listing Active Nodes",id:"listing-active-nodes",level:3},{value:"Node Information",id:"node-information",level:3},{value:"Listing Topics",id:"listing-topics",level:3},{value:"Topic Information",id:"topic-information",level:3},{value:"Echoing Topic Data",id:"echoing-topic-data",level:3},{value:"Publishing from Command Line",id:"publishing-from-command-line",level:3},{value:"Measuring Topic Frequency",id:"measuring-topic-frequency",level:3},{value:"Quality of Service (QoS) in ROS 2",id:"quality-of-service-qos-in-ros-2",level:2},{value:"Key QoS Parameters",id:"key-qos-parameters",level:3},{value:"Example: Reliable Communication",id:"example-reliable-communication",level:3},{value:"Best Practices for Nodes and Topics",id:"best-practices-for-nodes-and-topics",level:2},{value:"Node Design",id:"node-design",level:3},{value:"Topic Design",id:"topic-design",level:3},{value:"Performance Considerations",id:"performance-considerations",level:3},{value:"Summary",id:"summary",level:2},{value:"Review Questions",id:"review-questions",level:2},{value:"Hands-On Exercises",id:"hands-on-exercises",level:2}];function a(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"ros-2-nodes-and-topics",children:"ROS 2 Nodes and Topics"})}),"\n",(0,r.jsx)(s.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsx)(s.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Understand the architecture of ROS 2 nodes and their role in robotic systems"}),"\n",(0,r.jsxs)(s.li,{children:["Create publisher and subscriber nodes using ",(0,r.jsx)(s.code,{children:"rclpy"})," (ROS 2 Python library)"]}),"\n",(0,r.jsx)(s.li,{children:"Work with ROS 2 topics for asynchronous message passing"}),"\n",(0,r.jsx)(s.li,{children:"Use standard ROS 2 message types for sensor data and robot control"}),"\n",(0,r.jsx)(s.li,{children:"Debug and introspect running ROS 2 systems using command-line tools"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"introduction-to-ros-2-architecture",children:"Introduction to ROS 2 Architecture"}),"\n",(0,r.jsx)(s.p,{children:"ROS 2 (Robot Operating System 2) is a flexible framework for writing robot software. It's a collection of tools, libraries, and conventions that aim to simplify the task of creating complex and robust robot behavior across a wide variety of robotic platforms."}),"\n",(0,r.jsx)(s.h3,{id:"the-compute-graph",children:"The Compute Graph"}),"\n",(0,r.jsxs)(s.p,{children:["At the heart of ROS 2 is the ",(0,r.jsx)(s.strong,{children:"compute graph"}),"\u2014a peer-to-peer network of ROS 2 processes (nodes) that are collectively processing data. The compute graph concept enables:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Modularity"}),": Breaking complex systems into manageable, reusable components"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Distributed computing"}),": Nodes can run on different machines in a network"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Language agnosticism"}),": Nodes can be written in C++, Python, or other supported languages"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Loose coupling"}),": Nodes communicate through well-defined interfaces without direct dependencies"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"ros-2-nodes",children:"ROS 2 Nodes"}),"\n",(0,r.jsxs)(s.p,{children:["A ",(0,r.jsx)(s.strong,{children:"node"})," is a fundamental ROS 2 entity\u2014a single, modular process that performs a specific computation or task."]}),"\n",(0,r.jsx)(s.h3,{id:"node-characteristics",children:"Node Characteristics"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Single responsibility"}),": Each node should do one thing well (e.g., read sensor data, plan paths, control motors)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Independent execution"}),": Nodes run as separate operating system processes"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Communication"}),": Nodes interact through topics, services, actions, and parameters"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Discoverability"}),": Nodes announce their presence to the ROS 2 network automatically"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"node-examples-in-a-mobile-robot",children:"Node Examples in a Mobile Robot"}),"\n",(0,r.jsx)(s.p,{children:"Consider a mobile robot navigating a warehouse. It might have these nodes:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"camera_driver"}),": Publishes images from an RGB camera"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"lidar_driver"}),": Publishes laser scan data"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"localization"}),": Estimates robot position using sensor data"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"path_planner"}),": Computes collision-free paths to goals"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"controller"}),": Sends velocity commands to motor drivers"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"safety_monitor"}),": Emergency stop if obstacles are too close"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Each node operates independently but coordinates through message passing."}),"\n",(0,r.jsx)(s.h2,{id:"creating-your-first-node",children:"Creating Your First Node"}),"\n",(0,r.jsx)(s.p,{children:'Let\'s create a simple node that publishes a "Hello, ROS 2!" message.'}),"\n",(0,r.jsx)(s.h3,{id:"step-1-import-required-libraries",children:"Step 1: Import Required Libraries"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"rclpy"}),": The ROS 2 Python client library"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"Node"}),": Base class for all ROS 2 nodes"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"String"}),": A standard message type for text data"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"step-2-define-the-node-class",children:"Step 2: Define the Node Class"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"class HelloPublisher(Node):\n    def __init__(self):\n        super().__init__('hello_publisher')\n\n        # Create a publisher on the 'hello_topic' topic\n        self.publisher = self.create_publisher(String, 'hello_topic', 10)\n\n        # Create a timer that calls the callback every 1 second\n        self.timer = self.create_timer(1.0, self.timer_callback)\n\n        self.count = 0\n        self.get_logger().info('Hello Publisher node initialized')\n\n    def timer_callback(self):\n        # Create and publish a message\n        msg = String()\n        msg.data = f'Hello, ROS 2! Message #{self.count}'\n        self.publisher.publish(msg)\n        self.get_logger().info(f'Published: \"{msg.data}\"')\n        self.count += 1\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Key Components:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"super().__init__('hello_publisher')"}),': Initializes the node with name "hello_publisher"']}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"create_publisher()"}),": Creates a publisher for the ",(0,r.jsx)(s.code,{children:"String"}),' message type on topic "hello_topic"',"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"10"})," is the ",(0,r.jsx)(s.strong,{children:"queue size"}),"\u2014how many messages to buffer if subscribers can't keep up"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"create_timer()"}),": Schedules the callback function to run every 1.0 seconds"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"get_logger()"}),": Accesses the node's logging system for status messages"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"step-3-main-function",children:"Step 3: Main Function"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"def main(args=None):\n    # Initialize the ROS 2 Python client library\n    rclpy.init(args=args)\n\n    # Create an instance of the node\n    node = HelloPublisher()\n\n    # Spin the node so callbacks are called\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        # Clean shutdown\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"rclpy.init()"}),": Initializes the ROS 2 context (must be called before creating nodes)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"rclpy.spin()"}),": Keeps the node alive and processes callbacks"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"destroy_node()"})," and ",(0,r.jsx)(s.code,{children:"shutdown()"}),": Clean up resources when exiting"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"running-the-node",children:"Running the Node"}),"\n",(0,r.jsxs)(s.p,{children:["Save the code as ",(0,r.jsx)(s.code,{children:"hello_publisher.py"})," and run:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 hello_publisher.py\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'[INFO] [hello_publisher]: Hello Publisher node initialized\n[INFO] [hello_publisher]: Published: "Hello, ROS 2! Message #0"\n[INFO] [hello_publisher]: Published: "Hello, ROS 2! Message #1"\n[INFO] [hello_publisher]: Published: "Hello, ROS 2! Message #2"\n...\n'})}),"\n",(0,r.jsx)(s.h2,{id:"ros-2-topics",children:"ROS 2 Topics"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Topics"})," are named buses over which nodes exchange messages. Topics implement a ",(0,r.jsx)(s.strong,{children:"publish-subscribe"})," pattern:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Publishers"})," send messages to topics (one-to-many)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Subscribers"})," receive messages from topics"]}),"\n",(0,r.jsxs)(s.li,{children:["Communication is ",(0,r.jsx)(s.strong,{children:"asynchronous"}),"\u2014publishers don't wait for subscribers"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"topic-properties",children:"Topic Properties"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Typed"}),": Each topic has a message type (e.g., ",(0,r.jsx)(s.code,{children:"sensor_msgs/LaserScan"}),", ",(0,r.jsx)(s.code,{children:"geometry_msgs/Twist"}),")"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Anonymous"}),": Publishers and subscribers don't know about each other"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Buffered"}),": Recent messages are queued (queue depth configurable)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Many-to-many"}),": Multiple publishers and subscribers can use the same topic"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"topic-naming-conventions",children:"Topic Naming Conventions"}),"\n",(0,r.jsx)(s.p,{children:"Topics follow a hierarchical naming scheme:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/camera/image_raw"}),": Raw image from camera"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/robot1/cmd_vel"}),": Velocity commands for robot1"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/scan"}),": Laser scan data (relative to node's namespace)"]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Best Practices:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Use descriptive names: ",(0,r.jsx)(s.code,{children:"/front_camera/rgb"})," instead of ",(0,r.jsx)(s.code,{children:"/cam1"})]}),"\n",(0,r.jsxs)(s.li,{children:["Group related topics under namespaces: ",(0,r.jsx)(s.code,{children:"/sensors/lidar"}),", ",(0,r.jsx)(s.code,{children:"/sensors/imu"})]}),"\n",(0,r.jsxs)(s.li,{children:["Follow ROS conventions: ",(0,r.jsx)(s.code,{children:"cmd_vel"})," for velocity, ",(0,r.jsx)(s.code,{children:"odom"})," for odometry"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"creating-a-subscriber-node",children:"Creating a Subscriber Node"}),"\n",(0,r.jsx)(s.p,{children:'Now let\'s create a node that subscribes to the "hello_topic" and prints received messages.'}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass HelloSubscriber(Node):\n    def __init__(self):\n        super().__init__('hello_subscriber')\n\n        # Create a subscription to 'hello_topic'\n        self.subscription = self.create_subscription(\n            String,\n            'hello_topic',\n            self.listener_callback,\n            10\n        )\n\n        self.get_logger().info('Hello Subscriber node initialized')\n\n    def listener_callback(self, msg):\n        # This function is called whenever a message is received\n        self.get_logger().info(f'Received: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = HelloSubscriber()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Key Differences from Publisher:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"create_subscription()"})," instead of ",(0,r.jsx)(s.code,{children:"create_publisher()"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"listener_callback()"}),": Called automatically when messages arrive"]}),"\n",(0,r.jsx)(s.li,{children:"No timer needed\u2014callbacks are event-driven"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"running-publisher-and-subscriber-together",children:"Running Publisher and Subscriber Together"}),"\n",(0,r.jsx)(s.p,{children:"Terminal 1:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 hello_publisher.py\n"})}),"\n",(0,r.jsx)(s.p,{children:"Terminal 2:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"python3 hello_subscriber.py\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output (Terminal 2):"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'[INFO] [hello_subscriber]: Hello Subscriber node initialized\n[INFO] [hello_subscriber]: Received: "Hello, ROS 2! Message #5"\n[INFO] [hello_subscriber]: Received: "Hello, ROS 2! Message #6"\n...\n'})}),"\n",(0,r.jsx)(s.h2,{id:"standard-ros-2-message-types",children:"Standard ROS 2 Message Types"}),"\n",(0,r.jsx)(s.p,{children:"ROS 2 provides a rich set of standard message types for common robotics tasks:"}),"\n",(0,r.jsx)(s.h3,{id:"primitive-types-std_msgs",children:"Primitive Types (std_msgs)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from std_msgs.msg import String, Int32, Float64, Bool\n"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"String"}),": Text data"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"Int32"}),", ",(0,r.jsx)(s.code,{children:"Float64"}),": Numeric values"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"Bool"}),": True/false flags"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"geometry-messages-geometry_msgs",children:"Geometry Messages (geometry_msgs)"}),"\n",(0,r.jsx)(s.p,{children:"Used for positions, velocities, and poses:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from geometry_msgs.msg import Twist, Point, Pose, PoseStamped\n\n# Example: Velocity command for a mobile robot\ntwist = Twist()\ntwist.linear.x = 0.5   # Forward velocity (m/s)\ntwist.angular.z = 0.2  # Rotational velocity (rad/s)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"sensor-messages-sensor_msgs",children:"Sensor Messages (sensor_msgs)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from sensor_msgs.msg import LaserScan, Image, Imu, JointState\n\n# LaserScan: 2D/3D LiDAR data\n# Image: Camera images (RGB, depth, etc.)\n# Imu: Inertial measurement unit (acceleration, gyroscope)\n# JointState: Robot joint positions and velocities\n"})}),"\n",(0,r.jsx)(s.h3,{id:"navigation-messages-nav_msgs",children:"Navigation Messages (nav_msgs)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from nav_msgs.msg import Odometry, Path\n\n# Odometry: Robot position, orientation, and velocities\n# Path: Sequence of poses defining a trajectory\n"})}),"\n",(0,r.jsx)(s.h2,{id:"practical-example-velocity-publisher-for-a-mobile-robot",children:"Practical Example: Velocity Publisher for a Mobile Robot"}),"\n",(0,r.jsx)(s.p,{children:"Let's create a node that publishes velocity commands to drive a robot in a square pattern."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\nimport math\n\nclass SquareDriveNode(Node):\n    def __init__(self):\n        super().__init__('square_drive')\n\n        # Publisher for velocity commands\n        self.publisher = self.create_publisher(Twist, 'cmd_vel', 10)\n\n        # State machine for square pattern\n        self.state = 'forward'  # States: 'forward', 'turn'\n        self.distance_traveled = 0.0\n        self.angle_turned = 0.0\n\n        # Parameters\n        self.side_length = 2.0  # meters\n        self.linear_speed = 0.3  # m/s\n        self.angular_speed = 0.5  # rad/s\n\n        # Timer for control loop (10 Hz)\n        self.timer = self.create_timer(0.1, self.control_loop)\n\n        self.get_logger().info('Square Drive node initialized')\n\n    def control_loop(self):\n        twist = Twist()\n\n        if self.state == 'forward':\n            # Drive forward\n            twist.linear.x = self.linear_speed\n            twist.angular.z = 0.0\n\n            self.distance_traveled += self.linear_speed * 0.1  # dt = 0.1s\n\n            if self.distance_traveled >= self.side_length:\n                self.state = 'turn'\n                self.distance_traveled = 0.0\n                self.get_logger().info('Switching to turn')\n\n        elif self.state == 'turn':\n            # Turn 90 degrees\n            twist.linear.x = 0.0\n            twist.angular.z = self.angular_speed\n\n            self.angle_turned += self.angular_speed * 0.1\n\n            if self.angle_turned >= math.pi / 2:  # 90 degrees\n                self.state = 'forward'\n                self.angle_turned = 0.0\n                self.get_logger().info('Switching to forward')\n\n        self.publisher.publish(twist)\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SquareDriveNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        # Stop the robot on exit\n        stop_msg = Twist()\n        node.publisher.publish(stop_msg)\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Key Concepts Demonstrated:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"State machine"}),": Alternating between forward and turning states"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Dead reckoning"}),": Estimating distance/angle from velocity commands (not accurate in practice\u2014odometry is needed)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Control frequency"}),": 10 Hz control loop is typical for mobile robots"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Safety"}),": Sending zero velocity on shutdown"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"ros-2-command-line-tools",children:"ROS 2 Command-Line Tools"}),"\n",(0,r.jsx)(s.p,{children:"ROS 2 provides powerful CLI tools for introspecting and debugging running systems."}),"\n",(0,r.jsx)(s.h3,{id:"listing-active-nodes",children:"Listing Active Nodes"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 node list\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"/hello_publisher\n/hello_subscriber\n/square_drive\n"})}),"\n",(0,r.jsx)(s.h3,{id:"node-information",children:"Node Information"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 node info /hello_publisher\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"/hello_publisher\n  Subscribers:\n  Publishers:\n    /hello_topic: std_msgs/msg/String\n  Service Servers:\n  Service Clients:\n  Action Servers:\n  Action Clients:\n"})}),"\n",(0,r.jsx)(s.h3,{id:"listing-topics",children:"Listing Topics"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic list\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"/hello_topic\n/cmd_vel\n/parameter_events\n/rosout\n"})}),"\n",(0,r.jsx)(s.h3,{id:"topic-information",children:"Topic Information"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic info /hello_topic\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Type: std_msgs/msg/String\nPublisher count: 1\nSubscription count: 1\n"})}),"\n",(0,r.jsx)(s.h3,{id:"echoing-topic-data",children:"Echoing Topic Data"}),"\n",(0,r.jsx)(s.p,{children:"View messages in real-time:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic echo /hello_topic\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"data: 'Hello, ROS 2! Message #10'\n---\ndata: 'Hello, ROS 2! Message #11'\n---\n...\n"})}),"\n",(0,r.jsx)(s.h3,{id:"publishing-from-command-line",children:"Publishing from Command Line"}),"\n",(0,r.jsx)(s.p,{children:"Manually publish a message:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic pub /hello_topic std_msgs/msg/String \"data: 'Manual message'\"\n"})}),"\n",(0,r.jsx)(s.h3,{id:"measuring-topic-frequency",children:"Measuring Topic Frequency"}),"\n",(0,r.jsx)(s.p,{children:"Check how fast messages are being published:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"ros2 topic hz /cmd_vel\n"})}),"\n",(0,r.jsx)(s.p,{children:"Output:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"average rate: 10.003\n    min: 0.099s max: 0.101s std dev: 0.00050s window: 100\n"})}),"\n",(0,r.jsx)(s.h2,{id:"quality-of-service-qos-in-ros-2",children:"Quality of Service (QoS) in ROS 2"}),"\n",(0,r.jsxs)(s.p,{children:["ROS 2 introduces ",(0,r.jsx)(s.strong,{children:"QoS policies"})," that control message delivery characteristics. This is a major improvement over ROS 1."]}),"\n",(0,r.jsx)(s.h3,{id:"key-qos-parameters",children:"Key QoS Parameters"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Reliability"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"RELIABLE"}),": Guarantee delivery (like TCP)"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"BEST_EFFORT"}),": No guarantees (like UDP, lower latency)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Durability"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"VOLATILE"}),": Only send to active subscribers"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"TRANSIENT_LOCAL"}),": Late-joining subscribers receive recent messages"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"History"}),":"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"KEEP_LAST(n)"}),": Buffer last n messages"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"KEEP_ALL"}),": Buffer all messages (limited by system resources)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"example-reliable-communication",children:"Example: Reliable Communication"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy\n\n# Define QoS profile for reliable, ordered delivery\nqos_profile = QoSProfile(\n    reliability=ReliabilityPolicy.RELIABLE,\n    durability=DurabilityPolicy.TRANSIENT_LOCAL,\n    depth=10\n)\n\nself.publisher = self.create_publisher(\n    Twist,\n    'cmd_vel',\n    qos_profile\n)\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Sensor data"}),": Often uses ",(0,r.jsx)(s.code,{children:"BEST_EFFORT"})," for low latency"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Commands"}),": Use ",(0,r.jsx)(s.code,{children:"RELIABLE"})," to ensure delivery"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Configuration"}),": Use ",(0,r.jsx)(s.code,{children:"TRANSIENT_LOCAL"})," so late joiners get current config"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"best-practices-for-nodes-and-topics",children:"Best Practices for Nodes and Topics"}),"\n",(0,r.jsx)(s.h3,{id:"node-design",children:"Node Design"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Single Responsibility"}),": One node, one job"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Configurability"}),": Use ROS parameters for tunable values"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Error Handling"}),": Check return values, handle exceptions"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Logging"}),": Use ",(0,r.jsx)(s.code,{children:"get_logger()"})," instead of ",(0,r.jsx)(s.code,{children:"print()"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Graceful Shutdown"}),": Clean up resources in ",(0,r.jsx)(s.code,{children:"finally"})," blocks"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"topic-design",children:"Topic Design"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Naming"}),": Descriptive, hierarchical names"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Message Types"}),": Use standard types when possible"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Frequency"}),": Match publishing rate to consumer needs"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"QoS"}),": Choose appropriate reliability and durability"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Bandwidth"}),": Compress large messages (images, point clouds)"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Avoid busy loops"}),": Use timers or callbacks, not ",(0,r.jsx)(s.code,{children:"while True"})," with ",(0,r.jsx)(s.code,{children:"sleep()"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Minimize allocations"}),": Reuse message objects in high-frequency publishers"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Batch processing"}),": Process multiple messages together when latency allows"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Zero-copy"}),": Use intra-process communication when nodes run in the same process"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(s.p,{children:"In this chapter, we explored the fundamental building blocks of ROS 2:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Nodes"}),": Modular processes that perform specific tasks"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Topics"}),": Publish-subscribe message passing for asynchronous communication"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Message types"}),": Standard interfaces for sensor data, commands, and more"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Command-line tools"}),": Essential for debugging and introspection"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"QoS policies"}),": Fine-grained control over message delivery"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["With these concepts, you can build distributed robotic systems where independent nodes coordinate through message passing. In the next chapter, we'll explore ",(0,r.jsx)(s.strong,{children:"services and actions"}),"\u2014synchronous request-response communication and long-running tasks."]}),"\n",(0,r.jsx)(s.h2,{id:"review-questions",children:"Review Questions"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"What is the difference between a node and a topic in ROS 2?"}),"\n",(0,r.jsx)(s.li,{children:"Explain the publish-subscribe pattern. How does it differ from a request-response pattern?"}),"\n",(0,r.jsxs)(s.li,{children:["What are QoS policies, and when would you use ",(0,r.jsx)(s.code,{children:"RELIABLE"})," vs. ",(0,r.jsx)(s.code,{children:"BEST_EFFORT"}),"?"]}),"\n",(0,r.jsx)(s.li,{children:"Write pseudo-code for a subscriber that counts the number of messages received on a topic."}),"\n",(0,r.jsx)(s.li,{children:"How would you debug a scenario where a publisher is running but a subscriber isn't receiving messages?"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"hands-on-exercises",children:"Hands-On Exercises"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Temperature Monitor"}),": Create a publisher that publishes random temperature values (15-30\xb0C) every second, and a subscriber that prints a warning if temperature >25\xb0C."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Multi-Publisher"}),": Create two publishers sending messages to the same topic from different nodes. Verify that a single subscriber receives messages from both."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Parameterized Node"}),": Modify the ",(0,r.jsx)(s.code,{children:"SquareDriveNode"})," to accept ",(0,r.jsx)(s.code,{children:"side_length"})," and ",(0,r.jsx)(s.code,{children:"linear_speed"})," as ROS parameters instead of hardcoded values."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"CLI Practice"}),": Use ",(0,r.jsx)(s.code,{children:"ros2 topic"})," commands to:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"List all active topics"}),"\n",(0,r.jsxs)(s.li,{children:["Echo messages from ",(0,r.jsx)(s.code,{children:"/cmd_vel"})]}),"\n",(0,r.jsx)(s.li,{children:"Manually publish a velocity command"}),"\n",(0,r.jsx)(s.li,{children:"Measure the publishing frequency"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Complete code for these exercises is available in ",(0,r.jsx)(s.code,{children:"/static/code/ros2/chapter01/"}),"."]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Next Chapter"}),": ",(0,r.jsx)(s.a,{href:"/AI_COURSE_book/docs/module-01-ros2/week-03/ch02-services-actions",children:"Services and Actions"})]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>t});var i=n(6540);const r={},l=i.createContext(r);function o(e){const s=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(l.Provider,{value:s},e.children)}}}]);